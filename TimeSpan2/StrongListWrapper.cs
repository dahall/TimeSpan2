namespace System.Collections.Generic
{
	/// <summary>Takes a collection that supports an <see cref="IList"/> and makes it strongly typed like <see cref="List{T}"/>.</summary>
	/// <typeparam name="T">Type to cast object to from the provided <see cref="IList"/>.</typeparam>
	public class StrongListWrapper<T> : IList<T>, ICollection
	{
		private readonly IList list;

		/// <summary>Initializes a new instance of the <see cref="StrongListWrapper&lt;T&gt;"/> class.</summary>
		/// <param name="baseList">The base list.</param>
		public StrongListWrapper(IList baseList) => list = baseList;

		/// <summary>Gets the core list.</summary>
		/// <value>The core list.</value>
		public IList Core => list;

		/// <summary>Gets the number of elements contained in the <see cref="T:System.Collections.Generic.ICollection`1"/>.</summary>
		/// <value></value>
		/// <returns>The number of elements contained in the <see cref="T:System.Collections.Generic.ICollection`1"/>.</returns>
		public int Count => list.Count;

		int ICollection.Count => list.Count;

		/// <summary>Gets a value indicating whether the <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only.</summary>
		/// <value></value>
		/// <returns>true if the <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only; otherwise, false.</returns>
		public bool IsReadOnly => list.IsReadOnly;

		bool ICollection.IsSynchronized => list.IsSynchronized;

		object ICollection.SyncRoot => list.SyncRoot;

		/// <summary>Gets or sets the strongly typed object at the specified index.</summary>
		/// <value>The index of the list item to get.</value>
		public T this[int index]
		{
			get => (T)list[index];
			set => list[index] = value;
		}

		/// <summary>Adds an item to the <see cref="T:System.Collections.Generic.ICollection`1"/>.</summary>
		/// <param name="item">The object to add to the <see cref="T:System.Collections.Generic.ICollection`1"/>.</param>
		/// <exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only.</exception>
		public void Add(T item) => list.Add(item);

		/// <summary>Adds the range.</summary>
		/// <param name="items">The items.</param>
		public void AddRange(T[] items)
		{
			if (items is null)
			{
				throw new ArgumentNullException();
			}

			for (int i = 0; i < items.Length; i++)
			{
				list.Add(items[i]);
			}
		}

		/// <summary>Removes all items from the <see cref="T:System.Collections.Generic.ICollection`1"/>.</summary>
		/// <exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only.</exception>
		public void Clear() => list.Clear();

		/// <summary>Determines whether the <see cref="T:System.Collections.Generic.ICollection`1"/> contains a specific value.</summary>
		/// <param name="item">The object to locate in the <see cref="T:System.Collections.Generic.ICollection`1"/>.</param>
		/// <returns>
		/// true if <paramref name="item"/> is found in the <see cref="T:System.Collections.Generic.ICollection`1"/>; otherwise, false.
		/// </returns>
		public bool Contains(T item) => list.Contains(item);

		/// <summary>
		/// Copies the elements of the <see cref="T:System.Collections.Generic.ICollection`1"/> to an <see cref="T:System.Array"/>, starting
		/// at a particular <see cref="T:System.Array"/> index.
		/// </summary>
		/// <param name="array">
		/// The one-dimensional <see cref="T:System.Array"/> that is the destination of the elements copied from <see
		/// cref="T:System.Collections.Generic.ICollection`1"/>. The <see cref="T:System.Array"/> must have zero-based indexing.
		/// </param>
		/// <param name="arrayIndex">The zero-based index in <paramref name="array"/> at which copying begins.</param>
		/// <exception cref="T:System.ArgumentNullException"><paramref name="array"/> is null.</exception>
		/// <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="arrayIndex"/> is less than 0.</exception>
		/// <exception cref="T:System.ArgumentException">
		/// <paramref name="array"/> is multidimensional.
		/// -or- <paramref name="arrayIndex"/> is equal to or greater than the length of <paramref name="array"/>.
		/// -or- The number of elements in the source <see cref="T:System.Collections.Generic.ICollection`1"/> is greater than the available
		/// space from <paramref name="arrayIndex"/> to the end of the destination <paramref name="array"/>.
		/// -or- Type T cannot be cast automatically to the type of the destination <paramref name="array"/>.
		/// </exception>
		public void CopyTo(T[] array, int arrayIndex) => list.CopyTo(array, arrayIndex);

		/// <summary>Returns an enumerator that iterates through the collection.</summary>
		/// <returns>A <see cref="T:System.Collections.Generic.IEnumerator`1"/> that can be used to iterate through the collection.</returns>
		public IEnumerator<T> GetEnumerator() => new StrongListWrapperEnumerator<T>(list.GetEnumerator());

		/// <summary>Determines the index of a specific item in the <see cref="T:System.Collections.Generic.IList`1"/>.</summary>
		/// <param name="item">The object to locate in the <see cref="T:System.Collections.Generic.IList`1"/>.</param>
		/// <returns>The index of <paramref name="item"/> if found in the list; otherwise, -1.</returns>
		public int IndexOf(T item) => list.IndexOf(item);

		/// <summary>Inserts an item to the <see cref="T:System.Collections.Generic.IList`1"/> at the specified index.</summary>
		/// <param name="index">The zero-based index at which <paramref name="item"/> should be inserted.</param>
		/// <param name="item">The object to insert into the <see cref="T:System.Collections.Generic.IList`1"/>.</param>
		/// <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="index"/> is not a valid index in the <see cref="T:System.Collections.Generic.IList`1"/>.</exception>
		/// <exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.IList`1"/> is read-only.</exception>
		public void Insert(int index, T item) => list.Insert(index, item);

		/// <summary>Removes the first occurrence of a specific object from the <see cref="T:System.Collections.Generic.ICollection`1"/>.</summary>
		/// <param name="item">The object to remove from the <see cref="T:System.Collections.Generic.ICollection`1"/>.</param>
		/// <returns>
		/// true if <paramref name="item"/> was successfully removed from the <see cref="T:System.Collections.Generic.ICollection`1"/>;
		/// otherwise, false. This method also returns false if <paramref name="item"/> is not found in the original <see cref="T:System.Collections.Generic.ICollection`1"/>.
		/// </returns>
		/// <exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.ICollection`1"/> is read-only.</exception>
		public bool Remove(T item) => Remove(item);

		/// <summary>Removes the <see cref="T:System.Collections.Generic.IList`1"/> item at the specified index.</summary>
		/// <param name="index">The zero-based index of the item to remove.</param>
		/// <exception cref="T:System.ArgumentOutOfRangeException"><paramref name="index"/> is not a valid index in the <see cref="T:System.Collections.Generic.IList`1"/>.</exception>
		/// <exception cref="T:System.NotSupportedException">The <see cref="T:System.Collections.Generic.IList`1"/> is read-only.</exception>
		public void RemoveAt(int index) => list.RemoveAt(index);

		void ICollection.CopyTo(Array array, int index) => list.CopyTo(array, index);

		/// <summary>Returns an enumerator that iterates through a collection.</summary>
		/// <returns>An <see cref="T:System.Collections.IEnumerator"/> object that can be used to iterate through the collection.</returns>
		IEnumerator IEnumerable.GetEnumerator() => GetEnumerator();

		/// <summary>Enumerator class for the <see cref="StrongListWrapper{T}"/>.</summary>
		/// <typeparam name="ET">Type to cast object to from the provided <see cref="IEnumerator"/>.</typeparam>
		public class StrongListWrapperEnumerator<ET> : IEnumerator<ET>
		{
			private IEnumerator iEnum;

			internal StrongListWrapperEnumerator(IEnumerator ienum) => iEnum = ienum;

			/// <summary>Gets the element in the collection at the current position of the enumerator.</summary>
			/// <value></value>
			/// <returns>The element in the collection at the current position of the enumerator.</returns>
			public ET Current => (ET)iEnum.Current;

			/// <summary>Gets the element in the collection at the current position of the enumerator.</summary>
			/// <value></value>
			/// <returns>The element in the collection at the current position of the enumerator.</returns>
			object IEnumerator.Current => Current;

			/// <summary>Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.</summary>
			public void Dispose()
			{
				Reset();
				iEnum = null;
			}

			/// <summary>Advances the enumerator to the next element of the collection.</summary>
			/// <returns>
			/// true if the enumerator was successfully advanced to the next element; false if the enumerator has passed the end of the collection.
			/// </returns>
			/// <exception cref="T:System.InvalidOperationException">The collection was modified after the enumerator was created.</exception>
			public bool MoveNext() => iEnum.MoveNext();

			/// <summary>Sets the enumerator to its initial position, which is before the first element in the collection.</summary>
			/// <exception cref="T:System.InvalidOperationException">The collection was modified after the enumerator was created.</exception>
			public void Reset() => iEnum.Reset();
		}
	}
}